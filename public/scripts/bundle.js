(()=>{var e={76:e=>{e.exports={selectOne:function(e){return document.querySelector(e)},selectAll:function(e){return document.querySelectorAll(e)},clearText:function(e){return e.trim().toLowerCase()}}}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,a),i.exports}(()=>{"use strict";var e=a(76);document.addEventListener("DOMContentLoaded",(()=>{!function(){try{document.body.clientWidth<1400&&!window.location.href.includes("/auth")&&(document.body.style.zoom=.7,(0,e.selectOne)(".app").style.height=1.43*document.body.clientHeight+"px")}catch(e){}}(),function(){try{const t=io(),a=(0,e.selectAll)(".auth__header__item"),s=(0,e.selectAll)(".auth__form");a.forEach(((e,t)=>{e.addEventListener("click",(e=>{s.forEach((e=>e.classList.remove("auth__form--visible"))),s[t].classList.add("auth__form--visible"),a.forEach((e=>e.classList.remove("auth__header__item--active"))),a[t].classList.add("auth__header__item--active")}))}));const n=(0,e.selectOne)("#auth-signup"),i=n.querySelector("#avatar"),r=n.querySelector(".avatar > img"),l=n.querySelector("#first-name"),c=n.querySelector("#last-name"),o=n.querySelector("#signup-email"),d=n.querySelector("#signup-password"),u=n.querySelector("#error-display-signup");i.addEventListener("change",(e=>{if(e.target.files&&e.target.files[0]){let t=new FileReader;t.onload=function(e){r.src=e.target.result},t.readAsDataURL(e.target.files[0])}})),n.addEventListener("submit",(async a=>{a.preventDefault();const s=new FormData;s.append("avatar",i.files[0]),s.append("firstName",(0,e.clearText)(l.value)),s.append("lastName",(0,e.clearText)(c.value)),s.append("email",(0,e.clearText)(o.value)),s.append("password",d.value);let n=await fetch("/auth/signup",{method:"POST",body:s});if(n=await n.json(),n.ok)return t.emit("login",{user:n.result.user}),window.location.reload();u.innerHTML=`\n            <div class="alert">${n.message.substring(6)}</div>\n         `}));const m=(0,e.selectOne)("#auth-signin"),v=m.querySelector("#email"),g=m.querySelector("#password"),f=m.querySelector("#error-display-signin");m.addEventListener("submit",(async t=>{t.preventDefault();let a=await fetch("/auth/signin",{headers:{"Content-Type":"application/json; charset=utf-8"},method:"POST",body:JSON.stringify({email:(0,e.clearText)(v.value),password:g.value})});if(a=await a.json(),a.ok)return window.location.reload();f.innerHTML=`\n            <div class="alert">${a.message.substring(6)}</div>\n         `}))}catch(e){}}(),function(){const t=io(),a=(0,e.selectOne)("#chat-form"),s=a.querySelector("#typing-field"),n=a.querySelector('[name="userId"]'),i=a.querySelector("#send-message"),r=(0,e.selectOne)(".messages-list"),l=(0,e.selectOne)(".chat-list__ul");a.addEventListener("submit",(e=>{e.preventDefault(),r.innerHTML+=`\n         <li class="messages__item">\n           <div class="message-text send">\n               <p>${s.value.trim()}</p>\n               <time class="message-time">12:05</time>\n           </div>\n           <div class="message-owner-img">\n               <img src="${i.getAttribute("data-avatar")}" alt="">\n           </div>\n         </li>\n      `,t.emit("new-message",{message:s.value,userId:n.value}),e.target.reset()})),t.on("new-message",(e=>{r.innerHTML+=`\n         <li class="messages__item">\n           <div class="message-owner-img">\n               <img src="${e.message["user.avatar"]}" alt="">\n           </div>\n           <div class="message-text received">\n               <p>${e.message.messageText}</p>\n               <time class="message-time">12:05</time>\n           </div>\n         </li>\n       `})),t.on("login",(e=>{l.innerHTML+=`\n         <li class="chat-list__li active-contact" id="${e.user.userId}">\n             <div class="contact-img">\n                 <img src="${e.user.avatar}">\n                 <div class="active-indicator"></div>\n             </div>\n             <div class="chat-info">\n                 <h3 class="contact-name">${e.user.firstName}</h3>\n                 <div class="last-message"><strong>role: </strong>${e.user.role}</div>\n             </div>\n         </li>\n      `})),t.on("left",(e=>{n.value,t.emit("left-real",{id:n.value})})),t.on("disconnect",(()=>{t.broadcast.emit("left-real",{id:n.value})})),t.on("left-real",(e=>{document.querySelector(`#${e.id}`).classList.remove("active-contact")}))}()}))})()})();
//# sourceMappingURL=bundle.js.map